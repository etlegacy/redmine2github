{
    "children": null,
    "attachments": null,
    "relations": [
        {
            "id": 92,
            "issue_id": 234,
            "issue_to_id": 181,
            "relation_type": "relates",
            "delay": null
        }
    ],
    "changesets": [
        {
            "revision": "f184d0d2b97e5f2cec51a87c2e101cf6b93df9d9",
            "user": {
                "id": 3,
                "name": "IR4T4"
            },
            "comments": "game: set/reset XP Lua functions activated refs #234",
            "committed_on": "2013-03-06T18:10:04Z"
        },
        {
            "revision": "5862386ca4bf67a662df1cf29efc9b1c44ac1257",
            "user": {
                "id": 1,
                "name": "Radegast"
            },
            "comments": "lua: added XP Save script",
            "committed_on": "2013-11-17T21:13:11Z"
        },
        {
            "revision": "ea55f531d3fe1e5c01a7202d04495585e94c71fd",
            "user": {
                "id": 1,
                "name": "Radegast"
            },
            "comments": "lua: (xpsave) clean up",
            "committed_on": "2013-11-17T22:45:25Z"
        },
        {
            "revision": "de5685157b99c239e55c22ad34b04974c01f25e7",
            "user": {
                "id": 1,
                "name": "Radegast"
            },
            "comments": "lua: (xp save) prevent sql injections with modified cl_guid, refs #234",
            "committed_on": "2013-11-18T12:06:51Z"
        }
    ],
    "journals": [
        {
            "id": 1253,
            "user": {
                "id": 3,
                "name": "IR4T4"
            },
            "notes": "",
            "created_on": "2013-03-05T17:07:28Z",
            "details": [
                {
                    "property": "attr",
                    "name": "fixed_version_id",
                    "new_value": "7"
                }
            ]
        },
        {
            "id": 1268,
            "user": {
                "id": 3,
                "name": "IR4T4"
            },
            "notes": "G_XP_Set(clientNum , xp, skill, add) and G_ResetXP(clientNum) Lua functions are available.",
            "created_on": "2013-03-06T18:22:57Z",
            "details": [
                {
                    "property": "attr",
                    "name": "assigned_to_id",
                    "new_value": "13"
                },
                {
                    "property": "attr",
                    "name": "done_ratio",
                    "old_value": "0",
                    "new_value": "20"
                }
            ]
        },
        {
            "id": 1588,
            "user": {
                "id": 35,
                "name": "Dragonji"
            },
            "notes": "",
            "created_on": "2013-04-27T10:50:41Z",
            "details": [
                {
                    "property": "attr",
                    "name": "subject",
                    "old_value": "xpsave",
                    "new_value": "XP save"
                },
                {
                    "property": "attr",
                    "name": "description",
                    "old_value": "xpsave system would be nice\r\n\r\nsave xp while reconnect (eg 1 map), or reset xp after X maps after connecting\r\n\r\nEtPub like xpsave would be also nice :)",
                    "new_value": "XP save system would be nice.\r\n\r\nSave XP while reconnect (eg. 1 map), or reset XP after X maps after connecting.\r\n\r\nETPub like XP save would be also nice :)"
                }
            ]
        },
        {
            "id": 1718,
            "user": {
                "id": 3,
                "name": "IR4T4"
            },
            "notes": "",
            "created_on": "2013-06-03T09:57:09Z",
            "details": [
                {
                    "property": "attr",
                    "name": "priority_id",
                    "old_value": "3",
                    "new_value": "4"
                }
            ]
        },
        {
            "id": 1769,
            "user": {
                "id": 3,
                "name": "IR4T4"
            },
            "notes": "",
            "created_on": "2013-07-25T19:32:31Z",
            "details": [
                {
                    "property": "attr",
                    "name": "fixed_version_id",
                    "old_value": "7",
                    "new_value": "8"
                }
            ]
        },
        {
            "id": 1770,
            "user": {
                "id": 3,
                "name": "IR4T4"
            },
            "notes": "",
            "created_on": "2013-07-25T19:32:42Z",
            "details": [
                {
                    "property": "attr",
                    "name": "assigned_to_id",
                    "old_value": "13"
                }
            ]
        },
        {
            "id": 1919,
            "user": {
                "id": 3,
                "name": "IR4T4"
            },
            "notes": "",
            "created_on": "2013-09-05T21:13:39Z",
            "details": [
                {
                    "property": "attr",
                    "name": "fixed_version_id",
                    "old_value": "8",
                    "new_value": "9"
                }
            ]
        },
        {
            "id": 2046,
            "user": {
                "id": 3,
                "name": "IR4T4"
            },
            "notes": "",
            "created_on": "2013-10-06T15:53:21Z",
            "details": [
                {
                    "property": "attr",
                    "name": "fixed_version_id",
                    "old_value": "9",
                    "new_value": "11"
                }
            ]
        },
        {
            "id": 2272,
            "user": {
                "id": 1,
                "name": "Radegast"
            },
            "notes": "I started working on a Lua module which will provide XP save functionality using a database. It's the first Lua module that I've written and I have only tested it between two maps, so it is not ready yet and needs some clean up and improvement.\r\n\r\nIt should be useful to server admins until we add engine-side database support.\r\n\r\nluasql module with sqlite3 driver is required, but other database drivers may be used instead with a small change. It could also be tweaked to use file backend instead of a database.\r\n\r\n_EDIT:_ here is the script: https://github.com/etlegacy/lua_scripts/blob/master/xpsave/xpsave.lua",
            "created_on": "2013-11-17T21:25:20Z",
            "details": [
                {
                    "property": "attr",
                    "name": "assigned_to_id",
                    "new_value": "1"
                },
                {
                    "property": "attr",
                    "name": "fixed_version_id",
                    "old_value": "11",
                    "new_value": "8"
                },
                {
                    "property": "attr",
                    "name": "done_ratio",
                    "old_value": "20",
                    "new_value": "30"
                }
            ]
        },
        {
            "id": 2273,
            "user": {
                "id": 1,
                "name": "Radegast"
            },
            "notes": "One more thing, when engine-side database support is ready, it will be easy to migrate and import XP data from this script.",
            "created_on": "2013-11-17T21:27:46Z",
            "details": []
        },
        {
            "id": 2276,
            "user": {
                "id": 1,
                "name": "Radegast"
            },
            "notes": "I added a check in the script for valid guid which prevents sql injections, so people can now start testing this on their servers. \r\n\r\nThe right way to prevent sql injections would be using @con:prepare@ with @bind_names@, but this should be sufficient.",
            "created_on": "2013-11-18T13:58:26Z",
            "details": [
                {
                    "property": "attr",
                    "name": "done_ratio",
                    "old_value": "30",
                    "new_value": "60"
                }
            ]
        },
        {
            "id": 2278,
            "user": {
                "id": 1,
                "name": "Radegast"
            },
            "notes": "",
            "created_on": "2013-11-18T16:04:02Z",
            "details": [
                {
                    "property": "attr",
                    "name": "project_id",
                    "old_value": "1",
                    "new_value": "4"
                },
                {
                    "property": "attr",
                    "name": "category_id",
                    "old_value": "17",
                    "new_value": "22"
                },
                {
                    "property": "attr",
                    "name": "status_id",
                    "old_value": "1",
                    "new_value": "5"
                },
                {
                    "property": "attr",
                    "name": "fixed_version_id",
                    "old_value": "8",
                    "new_value": "4"
                },
                {
                    "property": "attr",
                    "name": "done_ratio",
                    "old_value": "60",
                    "new_value": "100"
                }
            ]
        },
        {
            "id": 5646,
            "user": {
                "id": 527,
                "name": "eLBati"
            },
            "notes": "Radegast wrote:\r\n> \r\n> _EDIT:_ here is the script: https://github.com/etlegacy/lua_scripts/blob/master/xpsave/xpsave.lua\r\n\r\nHi,\r\n\r\nI tried saving this script to *legacy* dir. I tried several versions of LuaSQLite3, saving *sqlite3.so* to *legacy/lualibs/luasql/sqlite3.so*, but it seems the *sqlite3.so* library is not able to run standard LUA functions, like *lua_settop* and *lua_checkstack*. See http://dev.etlegacy.com/boards/2/topics/431?r=2253#message-2253\r\n\r\nHow should this script be used?\r\n\r\nThanks",
            "created_on": "2015-12-11T18:42:32Z",
            "details": []
        },
        {
            "id": 5647,
            "user": {
                "id": 140,
                "name": "Spyhawk"
            },
            "notes": "Again, pretty much sure LuaSQL should be compiled with symbols so the Lua API can communicate with the database.\r\nThe files provided by the package managers seem not to provide them. I'm not a compiler expert but I'll try to have a look into this in the following days.",
            "created_on": "2015-12-11T20:37:30Z",
            "details": []
        },
        {
            "id": 5648,
            "user": {
                "id": 527,
                "name": "eLBati"
            },
            "notes": "Solved with http://dev.etlegacy.com/boards/2/topics/431?r=2280#message-2280",
            "created_on": "2015-12-11T23:05:29Z",
            "details": []
        },
        {
            "id": 5680,
            "user": {
                "id": 527,
                "name": "eLBati"
            },
            "notes": "Hi,\r\nI'm using xpsave.lua script and I get into the following problem: after having collected some XP, when I disconnect and reconnect, server log says\r\n<pre>Lua API: et_ClientBegin error running lua script: [string \"xpsave.lua\"]:186: bad argument #2 to 'G_XP_Set' (number has no integer representation)</pre>\r\nand XP is partially or totally not restored.\r\n\r\nDo you know why this happens?\r\nThanks",
            "created_on": "2015-12-14T23:02:09Z",
            "details": []
        },
        {
            "id": 5681,
            "user": {
                "id": 140,
                "name": "Spyhawk"
            },
            "notes": "XP is actually a float, not an integer. In previous Lua, \"all numbers were float\":http://www.lua.org/manual/5.3/manual.html#8.1. You might want to force initialization by using \"0.0\" instead of \"0\" only. \r\n\r\nnote: XP are float because of XP sharing between engineers, which divides points earned when constructing between them instead of only giving the whole set of points to the last engineer. If your issue happens only with engineers... then that's the issue.",
            "created_on": "2015-12-14T23:33:20Z",
            "details": []
        },
        {
            "id": 5683,
            "user": {
                "id": 527,
                "name": "eLBati"
            },
            "notes": "Spyhawk wrote:\r\n> XP is actually a float, not an integer. In previous Lua, \"all numbers were float\":http://www.lua.org/manual/5.3/manual.html#8.1. You might want to force initialization by using \"0.0\" instead of \"0\" only. \r\n\r\nDo you mean like this\r\nhttps://github.com/eLBati/etlegacy-lua_scripts/commit/b71a57dc1caf8a147da72139ce4203f62da39461\r\n?\r\n\r\n> \r\n> note: XP are float because of XP sharing between engineers, which divides points earned when constructing between them instead of only giving the whole set of points to the last engineer. If your issue happens only with engineers... then that's the issue.\r\n\r\nActually it surely happened when I was medic: I lost all 'light weapons' XP",
            "created_on": "2015-12-15T07:14:03Z",
            "details": []
        },
        {
            "id": 5704,
            "user": {
                "id": 527,
                "name": "eLBati"
            },
            "notes": "I am now testing\r\nhttps://github.com/Zelly/ZellyLuas/blob/master/ZXpSave.lua\r\non my server.\r\nIt seems to work so far",
            "created_on": "2015-12-20T14:07:50Z",
            "details": []
        }
    ],
    "watchers": [
        {
            "id": 9,
            "name": "Mateos"
        },
        {
            "id": 527,
            "name": "eLBati"
        }
    ],
    "time_entries": null,
    "id": 234,
    "project": {
        "id": 4,
        "name": "Lua scripts for the Legacy mod"
    },
    "tracker": {
        "id": 2,
        "name": "Feature"
    },
    "status": {
        "id": 5,
        "name": "Fixed"
    },
    "priority": {
        "id": 4,
        "name": "Normal"
    },
    "author": {
        "id": 110,
        "name": "Harlekin"
    },
    "assigned_to": {
        "id": 1,
        "name": "Radegast"
    },
    "category": {
        "id": 22,
        "name": "Lua scripts"
    },
    "fixed_version": {
        "id": 4,
        "name": "ALL"
    },
    "subject": "XP save",
    "description": "XP save system would be nice.\r\n\r\nSave XP while reconnect (eg. 1 map), or reset XP after X maps after connecting.\r\n\r\nETPub like XP save would be also nice :)",
    "start_date": "2013-03-05",
    "done_ratio": 100,
    "created_on": "2013-03-05T13:48:16Z",
    "updated_on": "2015-12-20T14:07:50Z",
    "closed_on": "2013-11-18T16:04:02Z"
}